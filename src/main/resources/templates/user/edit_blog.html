<!DOCTYPE html>
<html lang="zh" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <title>写博客</title>
    <link th:href="@{/editor/css/style.css}" rel="stylesheet"
          href="../../static/editor/css/style.css" />
    <link th:href="@{/editor/css/editormd.css}" rel="stylesheet"
          href="../../static/editor/css/editormd.css" />

    <link th:href="@{/bootstrap/css/bootstrap.min.css}" href="../../static/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
    <link th:href="@{/bootstrap/css/dash-board.css}" href="../../static/bootstrap/css/dash-board.css" rel="stylesheet"/>
    <link th:href="@{/bootstrap/css/site-min.css}" href="../../static/bootstrap/css/site-min.css" rel="stylesheet"/>
    <script th:src="@{/bootstrap/script/jquery-3.4.1.min.js}" src="../../static/bootstrap/script/jquery-3.4.1.min.js"></script>
    <script th:src="@{/bootstrap/js/bootstrap.min.js}" src="../../static/bootstrap/js/bootstrap.min.js"></script>
</head>
<body style="padding: 0">
<div style="width: 100%; height: 100%" id="top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <span class="navbar-brand">快来写一篇博客吧！</span>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#">发布博客</a></li>
                <li><a href="#">保存草稿</a></li>
                <li><a href="#">XXXX</a></li>
                <li><a href="#">返回首页</a></li>
            </ul>
            <form class="navbar-form navbar-left" role="search">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="博客标题(1-100)" style="width: 200px"/><!-- 700px -->
                </div>
            </form>
        </div>
    </div>
    <div style="width: 100%; height: 100%">
        <form name="mdEditorForm" style="padding-top: 0; height: 100%">
            <div id="test-editormd" style="width: 100%; height: 100%">
                <textarea style="display:none;" name="content" id="content"></textarea>
            </div>
        </form>
    </div>
</div>
<script th:src="@{/bootstrap/script/jquery-3.4.1.min.js}"
        src="../../static/bootstrap/script/jquery-3.4.1.min.js"></script>
<script th:src="@{/bootstrap/script/editormd.min.js}"
        src="../../static/bootstrap/script/editormd.min.js"></script>
<script type="text/javascript">
    var testEditor;

    $(function() {
        testEditor = editormd("test-editormd", {
            width   : "100%",
            height  : "100%",
            syncScrolling : "single",
            /* 静态浏览的话应该是../../static/editor/lib/ */
            path    : "../../editor/lib/",
            imageUpload : true,
            imageFormats : ["jpg", "jpeg", "gif", "png", "bmp", "webp"],
            imageUploadURL : "/file/fileUpload",

            /* 指定需要显示的功能按钮 */
            toolbarIcons : function() {
                //return ["undo", "redo", "|","bold", "italic","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","table","datetime","hr",  "||",  "watch", "fullscreen", "preview", "releaseIcon", "index"]
                return ["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","link","reference-link","image","code","preformatted-text","code-block","table","|","watch","preview","fullscreen","search","|","releaseIcon", "save", "index"]
            },

            /*自定义功能按钮，下面我自定义了2个，一个是发布，一个是返回首页*/
            toolbarIconTexts : {
                releaseIcon : "<span bgcolor=\"gray\">现在发布</span>",
                save : "<span bgcolor=\"red\">保存草稿</span>",
                index : "<span bgcolor=\"red\">返回顶部</span>",
            },

            /*给自定义按钮指定回调函数*/
            toolbarHandlers:{
                releaseIcon : function(cm, icon, cursor, selection) {
                    contentCommit();//提交表单代码在下面
                },
                save : function(cm, icon, cursor, selection){
                    contentCommit2();
                },
                index : function(){
                    window.location.href = '#top';
                },
            }
        });

        /*提交表单的js*/
        function contentCommit(){
            // var title = $("#title").val();
            // var content = $("#content").val();
            // var htmlContent = $("#htmlContent").val();

            // $.ajax({
            //     url: "/blog/save",
            //     data: {title:title, content:content, htmlContent:htmlContent},
            //     success:function () {
            //         alert("发布成功");
            //     },
            //     error:function () {
            //         alert("发布失败");
            //     }
            // });

            mdEditorForm.method = "post";
            mdEditorForm.action = "/blog/save";//提交至服务器的路径
            mdEditorForm.submit();
        }

        /*提交表单的js*/
        function contentCommit2(){
            mdEditorForm.method = "get";
            mdEditorForm.action = "http://www.baidu.com";//提交至服务器的路径
            mdEditorForm.submit();
        }

        /*
        // or
        testEditor = editormd({
            id      : "test-editormd",
            width   : "90%",
            height  : 640,
            path    : "../lib/"
        });
        */



    });
</script>
</body>
</html>